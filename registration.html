<!DOCTYPE html>
<html lang="th">
<head>
<meta charset="UTF-8">
<title>VASD ‚Äì ‡∏•‡∏á‡∏ó‡∏∞‡πÄ‡∏ö‡∏µ‡∏¢‡∏ô‡∏™‡∏±‡∏ï‡∏ß‡πå</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<style>
body {
  font-family: "Segoe UI", Tahoma, sans-serif;
  background:#f4f6f8;
  margin:0;
}
header {
  background:#fff;
  border-bottom:1px solid #ddd;
  padding:14px 20px;
  display:flex;
  justify-content:space-between;
  align-items:center;
}
.container {
  max-width:1400px;
  margin:auto;
  padding:20px;
}
.card {
  background:#fff;
  border-radius:10px;
  padding:20px;
  margin-bottom:20px;
  box-shadow:0 2px 6px rgba(0,0,0,.05);
}

.owner-grid {
  display:grid;
  grid-template-columns:2fr 1fr auto;
  gap:12px;
}
input, select {
  width:100%;
  padding:8px;
}
button {
  padding:10px 16px;
  border:none;
  border-radius:6px;
  cursor:pointer;
  font-weight:bold;
}
.btn-add { background:#6c757d; color:#fff; }
.btn-save { background:#2c7be5; color:#fff; }

button:disabled {
  opacity:.4;
  cursor:not-allowed;
}

table {
  width:100%;
  border-collapse:collapse;
}
th, td {
  border:1px solid #ddd;
  padding:6px;
  text-align:center;
}

.service-line {
  display:flex;
  gap:20px;
  justify-content:flex-start;
  align-items:center;
  flex-wrap:wrap;
}
.service-line label {
  display:flex;
  gap:6px;
  cursor:pointer;
  white-space:nowrap;
}
</style>
</head>

<body>

<header>
  <h2>üìù ‡∏•‡∏á‡∏ó‡∏∞‡πÄ‡∏ö‡∏µ‡∏¢‡∏ô‡∏™‡∏±‡∏ï‡∏ß‡πå ‚Äì VASD</h2>
</header>

<div class="container">

<!-- OWNER -->
<div class="card">
  <h3>‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÄ‡∏à‡πâ‡∏≤‡∏Ç‡∏≠‡∏á‡∏™‡∏±‡∏ï‡∏ß‡πå</h3>
  <div class="owner-grid">
    <input id="ownerName" placeholder="‡∏ä‡∏∑‡πà‡∏≠-‡∏™‡∏Å‡∏∏‡∏•" autofocus>
    <input id="phone" placeholder="‡πÄ‡∏ö‡∏≠‡∏£‡πå‡πÇ‡∏ó‡∏£">
    <button onclick="readThaiID()">üìá ‡∏≠‡πà‡∏≤‡∏ô‡∏ö‡∏±‡∏ï‡∏£‡∏õ‡∏£‡∏∞‡∏ä‡∏≤‡∏ä‡∏ô</button>
  </div>
</div>

<!-- ANIMAL -->
<div class="card">
  <h3>‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏™‡∏±‡∏ï‡∏ß‡πå</h3>

  <table>
    <thead>
      <tr>
        <th>‡∏ä‡∏∑‡πà‡∏≠‡∏™‡∏±‡∏ï‡∏ß‡πå</th>
        <th>‡∏ä‡∏ô‡∏¥‡∏î</th>
        <th>‡πÄ‡∏û‡∏®</th>
        <th>‡∏ô‡πâ‡∏≥‡∏´‡∏ô‡∏±‡∏Å (‡∏Å‡∏Å.)</th>
        <th>‡∏´‡∏±‡∏ï‡∏ñ‡∏Å‡∏≤‡∏£</th>
      </tr>
    </thead>
    <tbody id="animalBody"></tbody>
  </table>

  <br>
  <button class="btn-add" id="btnAdd" onclick="addAnimal()" disabled>
    ‚ûï ‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏™‡∏±‡∏ï‡∏ß‡πå
  </button>
</div>

<div class="card" style="text-align:center">
  <button class="btn-save" id="btnSave" onclick="saveAll()" disabled>
    üíæ ‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•
  </button>
</div>

</div>

<script>
/* ================= OWNER VALIDATION ================= */
const ownerName = document.getElementById("ownerName");
const phone = document.getElementById("phone");
const btnAdd = document.getElementById("btnAdd");
const btnSave = document.getElementById("btnSave");

function checkOwnerReady() {
  const ok = ownerName.value.trim() && phone.value.trim();
  btnAdd.disabled = !ok;
  btnSave.disabled = !ok;
}
ownerName.oninput = phone.oninput = checkOwnerReady;

/* ================= ANIMAL ================= */
function neuterText(sex) {
  return sex === "‡∏ú‡∏π‡πâ" ? "‡∏ó‡∏≥‡∏´‡∏°‡∏±‡∏ô‡πÄ‡∏û‡∏®‡∏ú‡∏π‡πâ (‡∏ï‡∏≠‡∏ô)" : "‡∏ó‡∏≥‡∏´‡∏°‡∏±‡∏ô‡πÄ‡∏û‡∏®‡πÄ‡∏°‡∏µ‡∏¢";
}

function serviceHTML(sex, species) {
  return `
  <div class="service-line">
    <label>
      <input type="checkbox" class="svc" value="${neuterText(sex)}" checked>
      ${neuterText(sex)}
    </label>
    <label>
      <input type="checkbox" class="svc" value="‡∏ß‡∏±‡∏Ñ‡∏ã‡∏µ‡∏ô‡∏û‡∏¥‡∏©‡∏™‡∏∏‡∏ô‡∏±‡∏Ç‡∏ö‡πâ‡∏≤">
      ‡∏ß‡∏±‡∏Ñ‡∏ã‡∏µ‡∏ô‡∏û‡∏¥‡∏©‡∏™‡∏∏‡∏ô‡∏±‡∏Ç‡∏ö‡πâ‡∏≤
    </label>
    ${species === "‡∏™" ? `
    <label>
      <input type="checkbox" class="svc" value="‡∏õ‡πâ‡∏≠‡∏á‡∏Å‡∏±‡∏ô‡πÄ‡∏´‡πá‡∏ö‡∏´‡∏°‡∏±‡∏î">
      ‡∏õ‡πâ‡∏≠‡∏á‡∏Å‡∏±‡∏ô‡πÄ‡∏´‡πá‡∏ö‡∏´‡∏°‡∏±‡∏î
    </label>` : ``}
  </div>`;
}

function addAnimal() {
  const tr = document.createElement("tr");
  tr.innerHTML = `
    <td><input class="petName"></td>
    <td>
      <select class="species">
        <option value="‡∏°">‡πÅ‡∏°‡∏ß</option>
        <option value="‡∏™">‡∏™‡∏∏‡∏ô‡∏±‡∏Ç</option>
      </select>
    </td>
    <td>
      <select class="sex">
        <option value="‡πÄ‡∏°‡∏µ‡∏¢">‡πÄ‡∏°‡∏µ‡∏¢</option>
        <option value="‡∏ú‡∏π‡πâ">‡∏ú‡∏π‡πâ</option>
      </select>
    </td>
    <td>
      <input type="number" min="0" step="0.1" value="3">
    </td>
    <td class="svcCell"></td>
  `;
  const species = tr.querySelector(".species");
  const sex = tr.querySelector(".sex");
  const svcCell = tr.querySelector(".svcCell");

  svcCell.innerHTML = serviceHTML("‡πÄ‡∏°‡∏µ‡∏¢","‡∏°");

  function refreshService() {
    const wasChecked =
      svcCell.querySelector(".svc")?.checked ?? true;
    svcCell.innerHTML = serviceHTML(sex.value, species.value);
    if (!wasChecked) {
      svcCell.querySelector(".svc").checked = false;
    }
  }

  species.onchange = refreshService;
  sex.onchange = refreshService;

  document.getElementById("animalBody").appendChild(tr);
}

/* ================= SAVE ================= */
function saveAll() {
  const rows = document.querySelectorAll("#animalBody tr");
  if (rows.length === 0) {
    alert("‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏™‡∏±‡∏ï‡∏ß‡πå‡∏≠‡∏¢‡πà‡∏≤‡∏á‡∏ô‡πâ‡∏≠‡∏¢ 1 ‡∏ï‡∏±‡∏ß");
    return;
  }

  for (const r of rows) {
    const name = r.querySelector(".petName").value.trim();
    const services = r.querySelectorAll(".svc:checked");

    if (!name) {
      alert("‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡πÉ‡∏™‡πà‡∏ä‡∏∑‡πà‡∏≠‡∏™‡∏±‡∏ï‡∏ß‡πå");
      return;
    }
    if (services.length === 0) {
      alert("‡∏ï‡πâ‡∏≠‡∏á‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏´‡∏±‡∏ï‡∏ñ‡∏Å‡∏≤‡∏£‡∏≠‡∏¢‡πà‡∏≤‡∏á‡∏ô‡πâ‡∏≠‡∏¢ 1 ‡∏≠‡∏¢‡πà‡∏≤‡∏á");
      return;
    }
  }

  generateQueueTicket();
}

/* ================= TICKET JPG ================= */
function generateQueueTicket() {
  const canvas = document.createElement("canvas");
  canvas.width = 600;
  canvas.height = 400;
  const ctx = canvas.getContext("2d");

  ctx.fillStyle = "#fff";
  ctx.fillRect(0,0,600,400);
  ctx.fillStyle = "#000";
  ctx.font = "28px Arial";
  ctx.fillText("VASD ‡∏ö‡∏±‡∏ï‡∏£‡∏Ñ‡∏¥‡∏ß", 200, 60);
  ctx.font = "20px Arial";
  ctx.fillText("‡πÄ‡∏à‡πâ‡∏≤‡∏Ç‡∏≠‡∏á: " + ownerName.value, 40, 120);
  ctx.fillText("‡πÇ‡∏ó‡∏£: " + phone.value, 40, 160);
  ctx.fillText("‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏£‡∏≠‡πÄ‡∏£‡∏µ‡∏¢‡∏Å‡∏Ñ‡∏¥‡∏ß", 40, 220);

  const a = document.createElement("a");
  a.href = canvas.toDataURL("image/jpeg");
  a.download = "VASD-queue.jpg";
  a.click();
}

/* ================= THAI ID ================= */
function readThaiID() {
  alert("‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏°‡∏ï‡πà‡∏≠‡πÄ‡∏Ñ‡∏£‡∏∑‡πà‡∏≠‡∏á‡∏≠‡πà‡∏≤‡∏ô‡∏ö‡∏±‡∏ï‡∏£‡∏õ‡∏£‡∏∞‡∏ä‡∏≤‡∏ä‡∏ô\n(‡∏à‡∏∞‡∏ï‡πà‡∏≠‡∏à‡∏£‡∏¥‡∏á‡πÄ‡∏°‡∏∑‡πà‡∏≠‡∏ó‡∏£‡∏≤‡∏ö‡∏£‡∏∏‡πà‡∏ô‡∏≠‡∏∏‡∏õ‡∏Å‡∏£‡∏ì‡πå)");
}
</script>

</body>
</html>
